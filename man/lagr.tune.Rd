% Generated by roxygen2 (4.0.1): do not edit by hand
\name{lagr.tune}
\alias{lagr.tune}
\title{Estimate the bandwidth parameter for a lagr model}
\usage{
lagr.tune(formula, data, family = gaussian, range = NULL, weights = NULL,
  coords, oracle = NULL, kernel = NULL, bw.type = c("dist", "knn", "nen"),
  varselect.method = c("AIC", "BIC", "AICc"), verbose = FALSE,
  longlat = FALSE, tol.loc = .Machine$double.eps^0.25,
  tol.bw = .Machine$double.eps^0.25, bwselect.method = c("AICc", "GCV",
  "BICg"), resid.type = c("deviance", "pearson"), na.action = c(na.omit,
  na.fail, na.pass), contrasts = NULL)
}
\arguments{
\item{formula}{symbolic representation of the model}

\item{data}{data frame containing observations of all the terms represented in the formula}

\item{weights}{vector of prior observation weights (due to, e.g., overdispersion). Not related to the kernel weights.}

\item{family}{exponential family distribution of the response}

\item{coords}{matrix of locations, with each row giving the location at which the corresponding row of data was observed}

\item{fit.loc}{matrix of locations where the local models should be fitted}

\item{longlat}{\code{TRUE} indicates that the coordinates are specified in longitude/latitude, \code{FALSE} indicates Cartesian coordinates. Default is \code{FALSE}.}

\item{kernel}{kernel function for generating the local observation weights}

\item{bw}{bandwidth for the kernel}

\item{bw.type}{type of bandwidth - options are \code{dist} for distance (the default), \code{knn} for nearest neighbors (bandwidth a proportion of \code{n}), and \code{nen} for nearest effective neighbors (bandwidth a proportion of the sum of squared residuals from a global model)}

\item{bwselect.method}{criterion to minimize when tuning bandwidth - options are \code{AICc}, \code{BICg}, and \code{GCV}}

\item{range}{allowable range of the bandwidth}

\item{tol.bw}{global error tolerance for minimizing the bandwidth selection criterion}

\item{tol.loc}{local error tolerance for converting an adaptive bandwidth (e.g. \code{knn} or \code{nen}) to a distance}

\item{varselect.method}{criterion to minimize in the regularization step of fitting local models - options are \code{AIC}, \code{AICc}, \code{BIC}, \code{GCV}}

\item{resid.type}{type of residual to use (relevant for non-gaussian response) - options are \code{deviance} and \code{pearson}}

\item{tuning}{logical indicating whether this model will be used to tune the bandwidth, in which case only the tuning criteria are returned}

\item{a}{pre-specified matrix of distances between locations}

\item{verbose}{print detailed information about our progress?}
}
\value{
\code{list(bw, trace)} where \code{bw} minimizes the bandwidth selection criterion and trace is a data frame of each bandwidth that was tried during the optimization, along with the resulting degrees of freedom used inthe LAGR model and the value of the bandwidth selection criterion.
}
\description{
\code{lagr.tune} estimates the bandwidth parameter for a LAGR model.
}
\details{
This method calls \code{lagr} repeatedly via the \code{optimize} function, searching for the bandwidth that minimizes a bandwidth selection criterion. It returns the profiled value of the selection criterion at each bandwidth that is used in the evaluation.
}

